# 测试每周菜谱推送

## 🧪 快速测试步骤

### 1. 设置环境变量

```bash
export FROM_EMAIL="545088576@qq.com"
export EMAIL_PASSWORD="uiynliuhutkybfjf"
export SMTP_SERVER="smtp.qq.com"
export SMTP_PORT="465"
```

### 2. 测试运行

```bash
cd scripts
python weekly_recipe_sender.py
```

### 3. 预期输出

```
============================================================
🍳 明日菜谱推送（1荤1素健康搭配）
============================================================
找到 XX 个健康荤菜
找到 XX 个健康素菜
选中荤菜: 炒菜/胡萝卜炒肉片
选中素菜: 烫菜/浇汁西兰花
正在连接邮件服务器 smtp.qq.com:465...
正在登录邮箱...
正在发送邮件...
✅ 邮件已成功发送到 huzhe06@gmail.com
============================================================
```

### 4. 检查邮件

打开邮箱 `huzhe06@gmail.com`，应该收到一封包含：

- ✅ 明日日期和星期
- ✅ 1个荤菜详情（配料、步骤）
- ✅ 1个素菜详情（配料、步骤）
- ✅ 所需食材清单（带购买链接）
- ✅ 美团小象超市一键购买按钮

## 🔍 检查点

### 邮件内容检查

- [ ] 邮件主题包含明日日期
- [ ] 显示1荤1素2个菜品
- [ ] 每个菜品有配料和步骤
- [ ] 食材清单可点击跳转美团
- [ ] 邮件排版美观（HTML格式）

### 功能检查

- [ ] 荤菜确实含有肉类
- [ ] 素菜不含肉类
- [ ] 食材链接可以正常访问
- [ ] 美团小象超市按钮有效

## ⚙️ 调试技巧

### 如果没有找到足够的菜品

编辑 `weekly_recipe_sender.py`，调整筛选条件：

```python
# 放宽油盐限制
is_low_oil = total_oil < 100  # 原来是80
is_low_salt = total_salt < 20  # 原来是15
```

### 如果荤素分类不准确

添加或修改关键词：

```python
# 添加更多荤菜关键词
self.meat_keywords = ['肉', '鸡', '鸭', '鱼', '虾', '牛', '猪', '蛋', ...]

# 添加更多素菜关键词
self.veg_keywords = ['青菜', '白菜', '西兰花', '豆腐', '菌菇', ...]
```

### 如果食材链接不对

编辑 `ingredient_links.py`，添加或修正食材映射：

```python
INGREDIENT_LINKS = {
    '新食材': 'https://s.meituan.com/v1/.../search/1?q=新食材',
    ...
}
```

## 📊 预期邮件效果预览

```
┌──────────────────────────────────────┐
│        🍽️ 明日菜谱推荐                   │
│      2025年01月15日 周二               │
└──────────────────────────────────────┘

💡 温馨提示：低油低盐，健康饮食。
   今日推荐1荤1素搭配，营养均衡！

┌─ 荤菜 ────────────────────────────┐
│  胡萝卜炒肉片                          │
│                                     │
│  ## 配料                             │
│  ▸ 猪肉                              │
│  ▸ 胡萝卜                            │
│  ▸ 葱姜蒜                            │
│  ▸ 盐、生抽                          │
│                                     │
│  ## 步骤                             │
│  ▸ 1. 猪肉切片，胡萝卜切片             │
│  ▸ 2. 热锅下油...                     │
└─────────────────────────────────┘

┌─ 素菜 ────────────────────────────┐
│  浇汁西兰花                          │
│                                     │
│  ## 配料                             │
│  ▸ 西兰花                            │
│  ▸ 豉油汁                            │
│                                     │
│  ## 步骤                             │
│  ▸ 1. 西兰花汆烫...                   │
│  ▸ 2. 淋上豉油汁                      │
└─────────────────────────────────┘

🛒 一键购买所需食材
┌─────────────────────────────────┐
│  [📱 打开美团小象超市]               │
└─────────────────────────────────┘

📝 所需食材清单
[猪肉] [胡萝卜] [西兰花] [葱] [姜] [蒜] [豉油汁]
(点击任意食材跳转购买页面)
```

## ✅ 测试完成

如果测试成功，你可以：

1. **配置GitHub Actions自动推送**
   - 在仓库添加 Secrets（FROM_EMAIL, EMAIL_PASSWORD）
   - 启用 "每周菜谱推送" workflow

2. **享受自动推送**
   - 每周日到周四晚上8点自动收到明日菜谱
   - 提前准备食材，轻松做饭

3. **自定义配置**
   - 修改收件邮箱
   - 调整推送时间
   - 自定义筛选条件

祝测试顺利！🎉

